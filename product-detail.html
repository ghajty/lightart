<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>商品詳情 - 貓貓燈具</title>
<style>
  body {
    margin:0; padding:0; font-family:Arial,sans-serif; background:#f9f9f9; color:#333;
    padding-top:env(safe-area-inset-top,0px);
  }
  .container {
    max-width:1000px; margin:0 auto; padding:20px; background:#fff; min-height:100dvh;
    box-shadow:0 0 10px rgba(0,0,0,0.05); border-radius:8px; margin-top:20px;
  }
  .back-btn {
    display:inline-block; margin-bottom:20px; padding:8px 16px; background:#333; color:#fff;
    text-decoration:none; border-radius:5px; font-size:0.9em;
  }
  .back-btn:hover {background:#555;}
  .product-detail {
    display:grid; grid-template-columns:1fr 1fr; gap:30px; align-items:start;
  }
  .product-img {
    width:100%; max-width:500px; height:auto; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1);
    object-fit:cover;
  }
  .product-info h1 {margin:0 0 15px; font-size:2em; color:#222;}
  .product-info .category {color:#e74c3c; font-weight:bold; margin-bottom:10px;}
  .product-info .price {font-size:1.8em; font-weight:bold; color:#e74c3c; margin:15px 0;}
  .product-info .desc {line-height:1.6; color:#555; margin-bottom:20px;}
  .add-to-cart {
    padding:12px 30px; background:#333; color:#fff; border:none; border-radius:6px;
    font-size:1.1em; cursor:pointer; width:100%; max-width:300px;
  }
  .add-to-cart:hover {background:#555;}
  @media (max-width:768px) {
    .product-detail {grid-template-columns:1fr;}
    .product-img {max-width:100%; height:auto;}
  }
</style>
</head>
<body>

<div class="container">
  <a href="index.html" class="back-btn">← 回商品列表</a>
  <div class="product-detail">
    <img id="detailImg" class="product-img" src="" alt="">
    <div class="product-info">
      <h1 id="detailName"></h1>
      <div class="category" id="detailCategory"></div>
      <div class="price" id="detailPrice"></div>
      <p class="desc" id="detailDesc"></p>
      <button class="add-to-cart" id="addToCartBtn">加入購物車</button>
    </div>
  </div>
</div>

<script>
// === 讀取 URL 參數 ===
const urlParams = new URLSearchParams(window.location.search);
const productId = parseInt(urlParams.get('id'));

// === 從 products.json 載入商品 ===
fetch('products.json')
  .then(res => res.json())
  .then(products => {
    const product = products.find(p => p.id === productId);
    if (!product) {
      document.body.innerHTML = '<div class="container"><p>商品不存在</p></div>';
      return;
    }

    // 填入資料
    document.getElementById('detailImg').src = product.img;
    document.getElementById('detailName').textContent = product.name;
    document.getElementById('detailCategory').textContent = product.category;
    document.getElementById('detailPrice').textContent = `$${product.price}`;
    document.getElementById('detailDesc').textContent = product.desc;

    // 加入購物車
    document.getElementById('addToCartBtn').onclick = () => {
      let cart = JSON.parse(localStorage.getItem('catlamp_cart') || '[]');
      const exist = cart.find(x => x.id === product.id);
      if (exist) exist.qty++;
      else cart.push({...product, qty:1});
      localStorage.setItem('catlamp_cart', JSON.stringify(cart));
      alert('已加入購物車！');
    };
  })
  .catch(err => {
    console.error(err);
    document.body.innerHTML = '<div class="container"><p>載入失敗</p></div>';
  });
</script>

</body>
</html>
