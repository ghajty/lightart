<!DOCTYPE html>
<input type="email" id="memberEmail" placeholder="Email (註冊用)">
<button type="submit" id="memberBtn">註冊 / 登入</button>
</form>
</div>
<div id="historySide" class="side-panel"><h2>歷史訂單</h2><ul id="historyListSide"></ul><button id="closeHistoryBtn">關閉</button></div>
<div id="introSide" class="side-panel"><h2>公司簡介</h2><p>貓貓燈具專注於提供各式吊燈、壁燈、吸頂燈、投射燈、燈條與軌道燈，結合設計美感與功能性，為每個空間帶來光與溫度。</p><button id="closeIntroBtn">關閉</button></div>
<div id="contactSide" class="side-panel"><h2>客服聯絡方式</h2><p>Email: support@catlamp.com</p><p>LINE: @catlamp</p><p>電話: 02-1234-5678</p><button id="closeContactBtn">關閉</button></div>
<div id="checkoutSide" class="side-panel"></div>
<div id="orderModal"></div>
<div id="modalOverlay" class="overlay"></div>
<script>
let products=[{id:1,name:"現代吊燈A",category:"吊燈",price:2500,img:"https://placekitten.com/300/180",desc:"適合客廳使用"},{id:2,name:"復古壁燈B",category:"壁燈",price:1200,img:"https://placekitten.com/301/180",desc:"適合走廊或臥室"},{id:3,name:"吸頂燈C",category:"吸頂燈",price:1800,img:"https://placekitten.com/302/180",desc:"節能又明亮"},{id:4,name:"投射燈D",category:"投射燈",price:900,img:"https://placekitten.com/303/180",desc:"可調整方向"},{id:5,name:"燈條E",category:"燈條",price:600,img:"https://placekitten.com/304/180",desc:"裝飾性強"},{id:6,name:"軌道燈F",category:"軌道燈",price:1500,img:"https://placekitten.com/305/180",desc:"適合展示空間"}];
const categories=["全部商品","吊燈","壁燈","吸頂燈","投射燈","燈條","軌道燈"];
let cart=[], currentMember=null;
function updateMemberUI(){
const welcome=document.getElementById("welcomeMsg"),logoutBtn=document.getElementById("logoutBtn"),memberForm=document.getElementById("memberForm");
if(currentMember){
welcome.textContent=`歡迎，${currentMember.username}`;
logoutBtn.style.display="inline-block";
memberForm.style.display="none";
cart=currentMember.cart||[];
renderHistorySide();
updateCartToggle();
}else{
welcome.textContent="";
logoutBtn.style.display="none";
memberForm.style.display="block";
cart=[];
renderHistorySide();
updateCartToggle();
}
}
document.getElementById("logoutBtn").addEventListener("click",()=>{currentMember=null;updateMemberUI();});
document.getElementById("memberForm").addEventListener("submit",e=>{
e.preventDefault();
const u=document.getElementById("memberUsername").value,p=document.getElementById("memberPassword").value,em=document.getElementById("memberEmail").value;
let members=JSON.parse(localStorage.getItem("members"))||[];
let member=members.find(m=>m.username===u);
if(member){
if(member.password===p){currentMember=member;}else{alert("密碼錯誤");return;}
}else{member={username:u,password:p,email:em,cart:[],orders:[]};members.push(member);localStorage.setItem("members",JSON.stringify(members));currentMember=member;}
updateMemberUI();
});
const categoryToggle=document.getElementById("categoryToggle"),categoryList=document.getElementById("categoryList");
categoryToggle.addEventListener("click",()=>{if(categoryList.style.display==="flex"){categoryList.style.display="none";categoryToggle.textContent="顯示分類 ▼";}else{categoryList.style.display="flex";categoryToggle.textContent="隱藏分類 ▲";}});
categories.forEach(cat=>{const btn=document.createElement("button");btn.textContent=cat;btn.addEventListener("click",()=>{displayProducts(cat);categoryList.querySelectorAll("button").forEach(b=>b.classList.remove("active"));btn.classList.add("active");});if(cat==="全部商品") btn.classList.add("active");categoryList.appendChild(btn);});
function displayProducts(filter="全部商品"){
const list=document.getElementById("productList");list.innerHTML="";
let filtered=filter==="全部商品"?products:products.filter(p=>p.category===filter);
filtered.forEach(p=>{
const div=document.createElement("div");
div.className="product-card";
div.innerHTML=`<img src="${p.img}" alt="${p.name}"><h3>${p.name}</h3><p>${p.desc}</p><p>價格: $${p.price}</p><button onclick="addToCart(${p.id})">加入購物車</button>`;
list.appendChild(div);
});
}
displayProducts();
function addToCart(productId){
const product=products.find(p=>p.id===productId),exist=cart.find(p=>p.id===product.id);
if(exist){exist.qty+=1;}else{cart.push({...product,qty:1});}
updateCartToggle();
}
function openCart(){
const checkoutSide=document.getElementById("checkoutSide");
renderCartItems();
if(cart.length>0){
const formDiv=document.createElement("div");
formDiv.innerHTML=`<h2>下單資料</h2><input type="text" id="name" placeholder="姓名" required><input type="tel" id="phone" placeholder="電話" required><input type="email" id="email" placeholder="Email" required><input type="text" id="address" placeholder="收貨地址" required><select id="payment" required><option value="">付款方式</option><option value="貨到付款">貨到付款</option><option value="線上付款">線上付款</option></select><button id="confirmCheckoutBtn">確認下單</button>`;
checkoutSide.appendChild(formDiv);
document.getElementById("confirmCheckoutBtn").addEventListener("click",()=>{
if(!currentMember){alert("請先登入會員");return;}
const order={id:Date.now(),name:document.getElementById("name").value,phone:document.getElementById("phone").value,email:document.getElementById("email").value,address:document.getElementById("address").value,payment:document.getElementById("payment").value,items:cart};
currentMember.orders=currentMember.orders||[];
currentMember.orders.push(order);
currentMember.cart=[];
updateMemberStorage();
cart=[];
renderCartItems();
document.getElementById("checkoutSide").style.display="none";
document.getElementById("modalOverlay").style.display="none";
alert(`訂單 #${order.id} 已成立，Email 已發送至 ${order.email}`);
updateMemberUI();
});
}
}
function renderCartItems(){
const checkoutSide=document.getElementById("checkoutSide");
checkoutSide.innerHTML="<h2>購物車</h2>";
if(cart.length===0){checkoutSide.innerHTML+="<p>購物車空空如也</p>";return;}
cart.forEach((item,index)=>{
const div=document.createElement("div");
div.className="cart-item";
div.innerHTML=`<img src="${item.img}" alt="${item.name}" style="width:60px;height:40px;object-fit:cover;border-radius:3px;margin-right:5px;"><span>${item.name} x ${item.qty} - $${item.price*item.qty}</span><div><button onclick="changeQty(${index},-1)">-</button><button onclick="changeQty(${index},1)">+</button><button onclick="removeItem(${index})">刪除</button></div>`;
checkoutSide.appendChild(div);
});
}
function changeQty(index,delta){cart[index].qty+=delta;if(cart[index].qty<1)cart[index].qty=1;openCart();}
function removeItem(index){cart.splice(index,1);openCart();}
function updateCartToggle(){const btn=document.getElementById("cartToggleBtn");if(currentMember && currentMember.orders && currentMember.orders.length>0){btn.style.display="inline-block";}else{btn.style.display="none";}}
document.getElementById("cartToggleBtn").addEventListener("click",()=>{const side=document.getElementById("checkoutSide"),overlay=document.getElementById("modalOverlay");if(side.style.display==="block"){side.style.display="none";overlay.style.display="none";}else{openCart();side.style.display="block";overlay.style.display="block";}});
function renderHistorySide(){const ul=document.getElementById("historyListSide");ul.innerHTML="";if(currentMember && currentMember.orders && currentMember.orders.length>0){currentMember.orders.forEach(o=>{const li=document.createElement("li"),totalQty=o.items.reduce((a,b)=>a+b.qty,0),totalPrice=o.items.reduce((a,b)=>a+b.qty*b.price,0);li.innerHTML=`訂單 #${o.id} | ${o.payment} | ${totalQty} 件 | $${totalPrice} <button class="viewDetail">查看明細</button>`;li.querySelector(".viewDetail").addEventListener("click",()=>{showOrderModal(o);});ul.appendChild(li);});}else ul.innerHTML="<li>尚無歷史訂單</li>";}
function showOrderModal(order){const modal=document.getElementById("orderModal");modal.innerHTML="";order.items.forEach(it=>{const div=document.createElement("div");div.textContent=`${it.name} x ${it.qty} - $${it.price*it.qty}`;modal.appendChild(div);});modal.innerHTML+=`<button onclick="closeOrderModal()">關閉</button>`;modal.style.display="block";document.getElementById("modalOverlay").style.display="block";}
function closeOrderModal(){document.getElementById("orderModal").style.display="none";document.getElementById("modalOverlay").style.display="none";}
document.getElementById("introBtn").addEventListener("click",()=>{document.getElementById("introSide").style.display="block";document.getElementById("modalOverlay").style.display="block";});
document.getElementById("historyBtn").addEventListener("click",()=>{document.getElementById("historySide").style.display="block";document.getElementById("modalOverlay").style.display="block";});
document.getElementById("contactBtn").addEventListener("click",()=>{document.getElementById("contactSide").style.display="block";document.getElementById("modalOverlay").style.display="block";});
document
