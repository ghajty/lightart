<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>後台管理 - 貓貓燈具</title>
<style>
body {font-family:Arial,sans-serif;background:#f5f5f5;margin:0;padding:20px;}
h1 {text-align:center;}
table {width:100%;border-collapse:collapse;margin-top:20px;}
th,td {border:1px solid #ccc;padding:8px;text-align:center;}
th {background:#333;color:white;}
button {padding:5px 10px;margin:2px;cursor:pointer;border:none;border-radius:4px;}
.add-form, .edit-form {margin-top:20px;background:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
</style>
</head>
<body>
<h1>後台管理 - 商品</h1>

<div class="add-form">
  <h3>新增商品</h3>
  <input type="text" id="addName" placeholder="名稱">
  <input type="text" id="addCategory" placeholder="分類">
  <input type="number" id="addPrice" placeholder="價格">
  <input type="text" id="addDesc" placeholder="描述">
  <input type="text" id="addImgs" placeholder="圖片網址(用逗號分隔)">
  <button id="addBtn">新增</button>
</div>

<table>
  <thead>
    <tr><th>ID</th><th>名稱</th><th>分類</th><th>價格</th><th>操作</th></tr>
  </thead>
  <tbody id="productTable"></tbody>
</table>

<script src="load-products.js"></script>
<script>
// 後台操作
function renderAdminTable(){
  const tbody = document.getElementById('productTable');
  tbody.innerHTML = '';
  products.forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${p.id}</td>
      <td>${p.name}</td>
      <td>${p.category}</td>
      <td>${p.price}</td>
      <td>
        <button onclick="editProduct(${p.id})">編輯</button>
        <button onclick="deleteProduct(${p.id})">刪除</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function addProduct(){
  const name = document.getElementById('addName').value.trim();
  const cat = document.getElementById('addCategory').value.trim();
  const price = parseFloat(document.getElementById('addPrice').value);
  const desc = document.getElementById('addDesc').value.trim();
  const imgs = document.getElementById('addImgs').value.split(',').map(i=>i.trim()).filter(i=>i);
  if(!name||!cat||isNaN(price)||imgs.length===0){alert('請完整填寫'); return;}
  const id = products.length>0 ? Math.max(...products.map(p=>p.id))+1 : 1;
  products.push({id,name,category:cat,price,desc,imgs});
  localStorage.setItem('catlamp_products',JSON.stringify(products));
  renderAdminTable();
  alert('新增成功');
}
function editProduct(id){
  const p = products.find(x=>x.id===id);
  if(!p) return;
  const name = prompt('名稱',p.name);
  const cat = prompt('分類',p.category);
  const price = parseFloat(prompt('價格',p.price));
  const desc = prompt('描述',p.desc);
  const imgs = prompt('圖片網址(用逗號分隔)',p.imgs.join(',')).split(',').map(i=>i.trim());
  if(name && cat && !isNaN(price) && imgs.length>0){
    Object.assign(p,{name,category:cat,price,desc,imgs});
    localStorage.setItem('catlamp_products',JSON.stringify(products));
    renderAdminTable();
  }
}
function deleteProduct(id){
  if(confirm('確定刪除?')){
    products = products.filter(x=>x.id!==id);
    localStorage.setItem('catlamp_products',JSON.stringify(products));
    renderAdminTable();
  }
}
document.getElementById('addBtn').onclick = addProduct;
window.onload = renderAdminTable;
</script>
</body>
</html>
